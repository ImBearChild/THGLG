---
title: "使用命令行"
---

# 使用 Shell

## 前言

**不论你使用的是哪种发行版，你总是会面对使用 Shell 控制系统的时候。本文将描述如何使用命令行进行控制系统。**

- 在此感谢 [Christopher Negus](https://www.wiley.com/en-us/search?pq=%7Crelevance%7Cauthor%3AChristopher+Negus) 先生所写的《[Linux Bible, 10th Edition](https://www.wiley.com/en-us/Linux+Bible%2C+10th+Edition-p-9781119578895)》，本文也是基于此书所成。
- **不要在终端中使用中文字符作为命令组成部分。**
- ~~你已经是一个成熟的 Linux 用户了，遇到本文没有提到的内容要学会自己去看源文档。~~

## 基本命令

Linux 上访问 shell 界面的方法有很多，其中在图形化界面下，打开桌面环境自带的终端应用程序（它一般叫“终端”或者“Terminal”），你就能直接看到一个命令行界面（CLI）提示符，例如：

```
[bh@c004-v1 ~]$
```

`bh` 是 Linux 用户的用户名，`c004-v1` 是 Linux 用户的主机名，`~` 表示 Linux 用户当前所在的文件夹是用户目录，即 `/home/bh`。

Linux 命令前自带的 `$` 字符表示此命令普通用户即可执行，`#` 表示此命令需要管理员权限才能执行，如

```
$ cp ~/Downloads/Tela-dark ~   #不需要管理员权限
# cp ~/Downloads/Tela-dark /usr/share/icons  #需要管理员权限
```

以上例子是将用户目录的下载文件（`~/Downloads`）内的 `Tela-dark` 的文件夹复制到两个地方，一个是用户目录（`~`），一个是共享文件夹（`/usr/share/icons`）。

要在 shell 中运行命名，只需要输入命令，然后按下 `Enter` 键即可，如：

```
[bh@c004-v1 ~]$ date
2022年 01月 17日 星期一 17:14:31 CST
```

`date` 命令可以用于显示当前的系统时间，日期和时区（输出内容的格式与你设置的语言和地区有关系）。相同命名还有 `uptime`，用于查看系统的开机时间。

```
[bh@c004-v1 ~]$ uptime
 17:16:26 up 9 min,  1 user,  load average: 0.05, 0.12, 0.11
```

如上，系统于 `17:16:26` 开机，已开机 9 分钟，共有一个已登录用户（`bh`），1 分钟，5 分钟和 15 分钟内的系统平均负载分别是 0.05、0.12 和 0.11。

系统负载（System Load）是系统 CPU 繁忙程度的度量，即有多少进程在等待被 CPU 调度（进程等待队列的长度）。平均负载（Load Average）是一段时间内系统的平均负载，这个一段时间一般取 1 分钟、5 分钟、15 分钟。

假设你的 CPU 是单核，它在单位时间内的事件处理能力有限的，当它被待处理事件填满，满负载运作的时候，load = 1；小于表示 CPU 未满载，大于 1 则表示超载工作，此时 CPU 不仅需要处理当前事务，还有更多的事务正在排队等待处理。如果你有一个四核 CPU，则当 load = 4 时，表示你的四个 CPU 核心均在满负载工作。

对于单核 CPU，当 load 超过 1 时，你应该检查一下什么东西占用了大量的 CPU 资源，以此类推。

此外还有几个命令值得一试：

```
[bh@c004-v1 ~]$ pwd
/home/bh
[bh@c004-v1 ~]$ hostname
c004-v1
[bh@c004-v1 ~]$ ls
公共  模板  视频  图片  文档  下载  音乐  桌面  Applications
[bh@c004-v1 ~]$ 
```

`pwd` 即，print working directory（打印你当前所在的文件夹至输出结果），`hostname` 用于显示你的主机名，`ls` 用于显示你所在文件夹的所有文件。

### 命令的语法

大多数命令都有一个或多个选项（option），你可以通过添加选项来改变命令的执行方式。

选项通常由一个前面带有连字符（`-`）的单个字母组成。你可以将单个字母选项组合在一起，或者在每个选项前面加上连字符以使用多个一次一个选项。例如下面两个使用 ls 命令的选项，效果是相同的：

```
$ ls -l -a -t
$ ls -lat
```

如上，你使用了 `-l`（长列表）、`-a`（显示包括隐藏文件在内的全部文件和文件夹）、`-t`（按时间排序） 修改了 `ls` 的运行模式。`ls` 命令用于显示当前目录的所有常规文件（默认不显示隐藏内容，即以 `.` 开头的文件或文件夹）。

一些命令的选项可能会使用单个单词来表示，要使用这些选项，你需要使用两个连字符（`--`），如 `--help`。如果没有这么做，系统尝试将这个单词理解成多个选项缩写字母组合在一起的选项。你可以将 `--help` 附加在绝大多数命令的后面，来获取有关该命令定义的选项和参数（argument）信息，例如：`uptime --help`。

许多命令会使用参数（argument），这些参数通常紧跟在选项的后面或者整个命令的末尾。参数本质是一条额外的信息，它可能是文件名、目录、用户名、设备或者其他东西，用于告知系统应该执行什么操作。例如：`cat /etc/hosts` 会将 `/etc/hosts` 中包含的信息打印在你的屏幕上，`/etc/hosts` 就是一个参数。你可以在命令行中输入很多个参数（数量取决于单行的字符数量限制）。

有时候，参数也会和选项联系在一起，此时，参数必须紧跟在选项的后面。如果选项是单个字母，请使用空格将参数与选项分割开，如果选项是一个单词，请使用等号将其连接起来，例如：

```
[bh@c004-v1 ~]$ ls --hide=FolderA
公共  模板  视频  图片  文档  下载  音乐  桌面  Applications
[bh@c004-v1 ~]$ ls
公共  模板  视频  图片  文档  下载  音乐  桌面  Applications  FolderA
```

如上，`--hide` 选项让 `ls` 在读取紧随其后的参数后，从输入结果中隐藏了 FolderA 文件夹。请注意，选项和参数用等号连接起来，中间不要有空格。

```
$ tar -cvf test.tar FolderA
```

如上，这是一个单字母选项用空格连接一个参数的例子。这条命令表示使用 `tar` 命令创建（`c`）一个名为 `test.tar` 的文件（`f`），并在创建备份时显示详细 (verbose，`v`) 消息；该文件包含 FolderA 文件夹中的所有子文件夹和文件（该命令还使用了相对路径，有关于此，将在后文详述）。因为 `test.tar` 是 `-f` 选项的参数，所以 `test.tar` 必须紧随其后（用空格隔开）。

你还可以使用 `uname` 查看系统版本，加上 `-a` 还可以查看内核版本，主机名，uptime 等信息，如下：

```
[bh@c004-v1 ~]$ uname -a
Linux c004-v1 5.15.14-200.fc35.x86_64 #1 SMP Tue Jan 11 16:49:27 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux
```

`id` 可用于查看你的用户名，加入的用户组，`who` 可以用于查阅你的用户名，登录的终端和时间。如下：

```
[bh@c004-v1 ~]$ who
bh       tty1         2022-01-17 17:06 (:0)
[bh@c004-v1 ~]$ id
用户id=1000(bh) 组id=1000(bh) 组=1000(bh),10(wheel) 上下文=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
```

如上，当你登录 Linux 的时候，Linux 会使用一系列的信息（用户名，组名，ID 等）识别你，跟踪你的活动。在此例中，数字化的用户 ID（UID）是 1000，用户 `bh` 所在的主要用户组是 `bh`，其组 ID（gid）是 1000。`bh` 还是 `wheel` 组（gid=10）的成员（即系统管理员）。

- 一般而言，用户所在的组应该是 `users`，但 Fedora 和 RHEL 及其衍生发行版都是采用 [User Private Groups](https://web.mit.edu/rhel-doc/3/rhel-rg-en-3/s1-users-groups-private-groups.html)，所以用户名通常和用户首要组相同。

